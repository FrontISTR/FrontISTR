# Doxygen MCP Server

Enables AI assistants (GitHub Copilot, Claude, etc.) to search and analyze XML documents generated by Doxygen for FrontISTR.

## Features

- Function, subroutine, and variable keyword search
- Module, class, and structure search
- Function call relationship tracking (caller/callee analysis)
- Source code location identification

## Setup

### Requirements

- Python 3.7 or higher
- Doxygen

### Installation

Create a Python virtual environment and install the required packages:

```bash
# Create virtual environment
python -m venv ai-tools/.venv

# Activate virtual environment
# Linux/macOS/WSL:
source ai-tools/.venv/bin/activate
# Windows (PowerShell):
ai-tools\.venv\Scripts\Activate.ps1
# Windows (cmd):
ai-tools\.venv\Scripts\activate.bat

# Install packages
pip install fastmcp
```

**Note**: When using VS Code on Windows with WSL development, create the virtual environment and install packages within WSL.

### Generate Doxygen Documentation

Enable `-DWITH_DOC=ON` in the CMake build directory to generate documentation:

```bash
cd build
cmake -DWITH_DOC=ON ..
make doc
```

This generates XML documents in `build/doc/xml/`.

### MCP Configuration

#### For VS Code (GitHub Copilot or Claude Extension)

Add the following configuration to `.vscode/mcp.json` and restart VS Code to start the MCP server.

**Linux/macOS:**
```json
{
  "servers": {
    "doxygen": {
      "type": "stdio",
      "command": "${workspaceFolder}/ai-tools/.venv/bin/python",
      "args": [
        "${workspaceFolder}/ai-tools/doxygen_mcp.py",
        "--xml", "${workspaceFolder}/build/doc/xml",
        "--html", "${workspaceFolder}/build/doc/html"
      ]
    }
  }
}
```

**Windows (WSL):**
```json
{
  "servers": {
    "doxygen": {
      "type": "stdio",
      "command": "wsl",
      "args": [
        "/mnt/c/path/to/your/workspace/ai-tools/.venv/bin/python",
        "/mnt/c/path/to/your/workspace/ai-tools/doxygen_mcp.py",
        "--xml", "/mnt/c/path/to/your/workspace/build/doc/xml",
        "--html", "/mnt/c/path/to/your/workspace/build/doc/html"
      ]
    }
  }
}
```

**Note**: In WSL environments, the `${workspaceFolder}` variable cannot be used. Replace the `/mnt/c/path/to/your/workspace` portions above with your actual workspace WSL path.

**Windows (Native):**
```json
{
  "servers": {
    "doxygen": {
      "type": "stdio",
      "command": "${workspaceFolder}/ai-tools/.venv/Scripts/python.exe",
      "args": [
        "${workspaceFolder}/ai-tools/doxygen_mcp.py",
        "--xml", "${workspaceFolder}/build/doc/xml",
        "--html", "${workspaceFolder}/build/doc/html"
      ]
    }
  }
}
```

#### For Other AI Assistants

Register the following commands according to your tool's MCP configuration:

**Linux/macOS:**
```bash
ai-tools/.venv/bin/python ai-tools/doxygen_mcp.py --xml build/doc/xml --html build/doc/html
```

**Windows (WSL):**
```bash
wsl /mnt/c/path/to/your/workspace/ai-tools/.venv/bin/python /mnt/c/path/to/your/workspace/ai-tools/doxygen_mcp.py --xml /mnt/c/path/to/your/workspace/build/doc/xml --html /mnt/c/path/to/your/workspace/build/doc/html
```

**Windows (Native):**
```cmd
ai-tools\.venv\Scripts\python.exe ai-tools\doxygen_mcp.py --xml build\doc\xml --html build\doc\html
```

## Usage

Ask AI assistants like GitHub Copilot Chat or Claude in natural language. The MCP server will be called automatically.

**Example queries**:
- "List the functions called by fstr_newton"
- "Search for functions that handle damping matrices in dynamic analysis"
- "Get a list of functions in the m_step module"

